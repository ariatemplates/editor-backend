Node common definition





# File system layout

- [`readme.md`](./readme.md): documentation file
- [`index.js`](./index.js): implementation file





# API

## Static methods

### Merge several nodes into one

#### Names

- `merge`

#### Description

Creates a new node by merging the nodes present in the array. The type of the new node will be the same as the first node in the list.

All flags and properties will be ignored.

#### Parameters

1. `nodes`
	- type: `Array`
	- Array of consecutive nodes to merge.

#### Return

- type: `Node`



## Methods

### Adds _something_ to the node

Generic function to add something to the node: a flag, a child, a list of children, or a property.

#### Names

- `put`

#### Description

__WARNING__: won't work along with factories, the input must be a node or a list of nodes if you want to add nodes, otherwise you will add a property.



### Add a child to the node

Adds a `child` node with the given `id`.

#### Names

- `add`



### Add a list of children to the node

Adds a list of children nodes with the given id.

#### Names

- `addList`

#### Description

These children are concatenated to the internal list of children, and each of them receives an the id along with an index property, 0-based indexed from the given list.

The list is directly added under the given id to the children index.



### Manage flags on a node

#### Names

- `flag`: add the given `flag`
- `unflag`: removes the given `flag`
- `is`: tests the existence of the `flag`



### Add errors and warnings to a node

#### Names

- `addError`: adds the given `error` inside the `errors` property of the node
- `addWarning`: adds the given `warning` inside the `warnings` property of the node

#### Parameters

1. `error`/`warning`
	- type: `String`
	- The message of the error/warning



### Move the location of a node

#### Names

- `moveContextLocation`

#### Parameters

1. `offset`
	- type: `Position`

#### Description

Changes the location as if a certain string was prepended to the source. The string is described by the position of its end.



### Traverse the graph of node

#### Names

- `traverse`

#### Description

This is a node/parent-first traversing (top-down).

#### Backlog

- introduce other traversing orders, like `bottom-up` = `children-first` = `depth-first`



### Pick nodes

Picks up node matching the given predicate by traversing the graph.

#### Names

- `pick`



### Convert the graph of nodes to a simplified object form

Converts the graph into an object with a certain format.

#### Names

- `toObject`

#### Description

Here is the format of the output object: 

- Type: 
	- key: `type`
	- format: the output of `NodeType.toJSON`
- Location: 
	- remark: start location only for now
	- key: `location`
	- format: the output of `Location.toJSON`
- Properties: 
	- key: `properties`
	- output: not touched
- Flags
	- key: `flags`
	- output: not touched
- Children
	- key: `children`
	- output: list of children simplified in a recursive way by using this method



### Copy the graph

Returns a copy of the graph.

#### Names

- `copy`

#### Description

This actually recursively recreates the graph, adding children copies and so on.

__WARNING__: the properties object however is not deeply cloned! We don't know what is put inside, and don't wanna perform a generic clone algorithm for now...



### Check the coverage of the corresponding source code by the graph

Check the coverage status of the children of a node.

#### Names

- `checkCoverage`

#### Description

For a node to be covered entirely, its children must cover the whole range of location.

Example of coverage:

- `node`: [0, 10]
- `children`: [[0, 1], [1, 5], [5, 10]]

Example of no coverage:

- `node`: [0, 10]
- `children`: [[1, 3], [5, 9]]



### Get a unique id for the node inside its graph

Generates a unique id to be able to identify the node.

#### Names

- `getId`



### Get a simplified structure of the graph

Creates a copy of the graph with a simplified structure.

A bit similar to `toOject`.

#### Names

- `simplify`

#### Description

Simplifies the graph structure (each object's structure).

Format of the output object: 

- Id: 
	- key: `id`
	- optional: yes, but makes sense only for the root node
	- format: depending on the existence of each of the two properties, gives either:
		- `<id>`
		- `<id>.<index>`
		- `<index>`
	 - nothing
- Type: 
	- key: `type`
	- format: `<language>.<element>`
- Location: 
	- remark: start location only for now
	- key: `loc`
	- format: `L<line> C<column> (<index>)`
- Properties: 
	- key: `props`
	- optional: yes
	- output: not touched
- Children:
	- key: `children`
	- optional: yes
	- output: list of simplified children

#### Backlog

- handle flags
- change the format to avoid objects (already serialize the list of properties for instance): take care of the `simpleTree` method which depends on this one!



### Get a minimalistic representation of the graph as a simple tree

Builds a simple tree from the graph.

- __recursive__
- see: `simplify`

#### Names

- `simpleTree`

#### Description

This internally uses the simplified representation, and this documentation uses this model.

Each node has the following format:

```javascript
{
	"<id | 'root'>: <type> (<loc>) [<properties>]": //list of children converted to simple trees
}
```

#### Return

- type: `Node`
- a node converted to a simple tree
