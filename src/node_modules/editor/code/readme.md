Code

__Representation of a source code unit.__ Sometimes called _source file_, or _document_. In more specialized contexts this can also be called _module_.





# File system layout

- [`readme.md`](./readme.md): documentation file
- [`index.js`](./index.js): implementation file





# Introduction

> What do you call a source code unit?

First, a [source code](http://en.wikipedia.org/wiki/Source_code) is a piece of text written in a programming language.

A unit is just something that is taken as a whole. So in this case a whole means that there is a notion of position, with the beginning of the unit and its end.

More concretely, it's like a file containing text, a special kind of text in this case.

> What are the different representations?

The first one is the basic one, what the user enters and reads: the text itself. We call it `source`.

The second is a specific representation for programming languages: a graph. See the [node](../node/) documentation for more information.





# API

## Methods

### Update the content of the code

#### Names

- `update`

#### Description

Updates the different models of a code.

For that, it requires its main model to be updated, all the inferred/computed models will be updated from that then.

In this case, the text content must be updated, and this is done by applying the provided _diff_.

#### Backlog

- error persistence: pad values of the time-stamp used for the new folder. Example: `01`, `02`, etc. for months, ...
- location specifications: 
	- be able to specify a position property, for insertion, less confusing than the unique start or end property
	- ? be able to specify a length property (computing end or start)
	- ? be able to specify a unique end property for insertion (like it does for now with unique start)
- specifications of input's models: 
	- split the input specification in more models: one for location. By the way `Location` should be made standard, and here location properties could be mixed with other properties.
	- the input definition of a graph is not the same: it takes no text, since it considers the source property is already up to date. So just take the input specification of the other methods, just without the text. That is: combine specifications

#### Implementation details

__WARNING__: be careful of being efficient in this method, it is critical as this is the one called the most often.



### Manage a set of values computed by mode's services

#### Names

- `setCache(key, value)`: adds the given `value` under the given `key`
- `getCache(key)`: returns the value corresponding to the given `key`
- `resetCache`: clears all the values

#### Description

A mode computes different information for a code instance. For example: highlighting, validation, etc.

As long as the code content doesn't change, this information remains the same. It is therefore useless to recompute them several times if they are requested several times (by clients). This can even be a performance issue.

That's why a code instance maintains a set of information, used as a cache.




# Backlog

## Line/column model

__For performances, editors usually use a specific model to represent text, smarter than the one of a whole string.__

The most obvious model of a text as viewed in an editor is the __2D one: lines and columns__.

This model should be implemented here, and used by some mode services as well if this can provide more efficiency.
